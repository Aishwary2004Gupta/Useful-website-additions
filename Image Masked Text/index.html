<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Image Masked Text — cover / contain / percent</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Google Fonts bundle -->
    <link
      href="https://fonts.googleapis.com/css2?family=Bebas+Neue&family=Inter:wght@400;700;900&family=Montserrat:wght@400;700;900&family=Playfair+Display:wght@400;700;900&family=Poppins:wght@400;600;800&display=swap"
      rel="stylesheet"
    />
    <style>
      :root {
        --img: url("https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?q=80&w=1600&auto=format&fit=crop");
        --bg-size: cover; /* cover | contain | <percent>% */
        --posX: 50%;
        --posY: 50%;
        --font: "Bebas Neue", system-ui, sans-serif;
        --weight: 900;
        --fallback: #111;
        --stroke-w: 0px;
        --stroke-c: rgba(0, 0, 0, 0);
      }

      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        min-height: 100svh;
        background: radial-gradient(
            1200px 800px at 70% -20%,
            #1b1b1b 0,
            #0d0d0d 55%
          ),
          #0b0b0b;
        color: #dcdcdc;
        font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial,
          sans-serif;
        display: grid;
        grid-template-rows: auto 1fr;
      }

      header {
        padding: 10px 14px;
        border-bottom: 1px solid #222;
        background: #0f0f10;
        display: flex;
        gap: 10px;
        align-items: center;
        justify-content: space-between;
      }
      header h1 {
        font-size: 16px;
        font-weight: 700;
        letter-spacing: 0.4px;
        margin: 0;
        color: #f1f1f1;
      }
      .container {
        display: grid;
        grid-template-columns: 360px 1fr;
        gap: 16px;
        padding: 16px;
      }
      @media (max-width: 920px) {
        .container {
          grid-template-columns: 1fr;
        }
      }

      /* Controls panel */
      .panel {
        background: #121214;
        border: 1px solid #1f1f22;
        border-radius: 14px;
        padding: 14px;
        display: grid;
        gap: 12px;
        align-content: start;
        position: sticky;
        top: 16px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.35);
      }
      .panel h2 {
        margin: 4px 0 6px;
        font-size: 13px;
        font-weight: 800;
        text-transform: uppercase;
        letter-spacing: 0.12em;
        color: #bdbdbd;
      }
      .row {
        display: grid;
        gap: 6px;
      }
      label {
        font-size: 12px;
        color: #a7a7a7;
      }
      input[type="text"],
      select,
      input[type="url"],
      input[type="number"] {
        width: 100%;
        padding: 10px 12px;
        border-radius: 10px;
        border: 1px solid #2a2a2f;
        background: #0e0e10;
        color: #e8e8e8;
        outline: none;
      }
      input[type="range"] {
        width: 100%;
      }
      .inline {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
      }
      .btns {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
      }
      button {
        padding: 9px 12px;
        border-radius: 10px;
        border: 1px solid #2a2a2f;
        background: #17171a;
        color: #f0f0f0;
        cursor: pointer;
      }
      button:hover {
        background: #1b1b1f;
      }
      .secondary {
        background: #0f0f12;
      }

      /* Stage */
      .stage {
        display: grid;
        place-items: center;
        padding: 16px;
        border: 1px dashed #242428;
        border-radius: 14px;
        min-height: 64svh;
        position: relative;
        overflow: hidden;
        background: radial-gradient(
            1600px 800px at 20% 120%,
            rgba(255, 255, 255, 0.03),
            transparent 60%
          ),
          linear-gradient(180deg, rgba(255, 255, 255, 0.02), transparent);
      }

      .masked-wrap {
        display: grid;
        gap: 16px;
        text-align: center;
        max-width: min(1100px, 95%);
      }

      .masked-text {
        font-family: var(--font);
        font-weight: var(--weight);
        font-size: clamp(2.2rem, 14vw, 12rem);
        line-height: 0.92;
        letter-spacing: 0.02em;
        margin: 0 auto;
        /* The mask */
        background-image: var(--img);
        background-repeat: no-repeat;
        background-position: var(--posX) var(--posY);
        background-size: var(--bg-size);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        -webkit-text-fill-color: transparent;

        /* Optional outline to boost contrast on dark UIs */
        -webkit-text-stroke: var(--stroke-w) var(--stroke-c);
        text-shadow: 0 0 calc(var(--stroke-w)) var(--stroke-c);
        user-select: text;
      }

      /* Fallback solid text mode (disable the image clip) */
      .fallback .masked-text {
        background-image: none !important;
        color: var(--fallback);
        -webkit-text-fill-color: var(--fallback);
        -webkit-text-stroke: 0 transparent;
        text-shadow: none;
      }

      .hint {
        font-size: 12px;
        color: #9d9d9d;
        margin-top: -6px;
      }
      .kbd {
        border: 1px solid #2a2a2f;
        padding: 2px 6px;
        border-radius: 6px;
        background: #0b0b0e;
        font-size: 11px;
      }
    </style>
  </head>
  <body>
    <header>
      <h1>Image Masked Text</h1>
      <div class="btns">
        <button
          id="toggleFallback"
          class="secondary"
          title="Toggle fallback color mode"
        >
          Toggle Fallback
        </button>
        <button id="reset">Reset</button>
      </div>
    </header>

    <main class="container">
      <!-- Controls -->
      <section class="panel" id="panel">
        <h2>Text</h2>
        <div class="row">
          <label for="text">Content</label>
          <input id="text" type="text" value="MASKED TEXT" />
          <div class="hint">
            Tip: You can also click the text and type directly.
          </div>
        </div>

        <div class="inline">
          <div class="row">
            <label for="font">Font family</label>
            <select id="font">
              <option value='"Bebas Neue", system-ui, sans-serif' selected>
                Bebas Neue (display)
              </option>
              <option value='"Montserrat", system-ui, sans-serif'>
                Montserrat
              </option>
              <option value='"Playfair Display", serif'>
                Playfair Display
              </option>
              <option value='"Poppins", system-ui, sans-serif'>Poppins</option>
              <option value="Inter, system-ui, sans-serif">Inter</option>
              <option value="system-ui, sans-serif">system-ui</option>
            </select>
          </div>
          <div class="row">
            <label for="weight"
              >Weight <span id="weightVal" class="kbd">900</span></label
            >
            <input
              id="weight"
              type="range"
              min="100"
              max="900"
              step="100"
              value="900"
            />
          </div>
        </div>

        <div class="row">
          <label>Fit mode</label>
          <div class="inline">
            <select id="fit">
              <option value="cover" selected>cover</option>
              <option value="contain">contain</option>
              <option value="percent">percent</option>
            </select>
            <div class="row">
              <label for="percent"
                >Percent size (<span id="pctVal" class="kbd">120%</span>)</label
              >
              <input
                id="percent"
                type="range"
                min="20"
                max="300"
                step="1"
                value="120"
              />
            </div>
          </div>
          <div class="inline">
            <div class="row">
              <label for="posX"
                >Pos X (<span id="posXVal" class="kbd">50%</span>)</label
              >
              <input
                id="posX"
                type="range"
                min="0"
                max="100"
                step="1"
                value="50"
              />
            </div>
            <div class="row">
              <label for="posY"
                >Pos Y (<span id="posYVal" class="kbd">50%</span>)</label
              >
              <input
                id="posY"
                type="range"
                min="0"
                max="100"
                step="1"
                value="50"
              />
            </div>
          </div>
        </div>

        <h2>Image</h2>
        <div class="row">
          <label for="img">Image URL</label>
          <input
            id="img"
            type="url"
            placeholder="https://…"
            value="https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?q=80&w=1600&auto=format&fit=crop"
          />
          <div class="btns">
            <button id="useSample1" class="secondary">Sample – Nature</button>
            <button id="useSample2" class="secondary">Sample – City</button>
            <button id="useSample3" class="secondary">Sample – Abstract</button>
          </div>
        </div>

        <h2>Styling</h2>
        <div class="inline">
          <div class="row">
            <label for="fallback">Fallback color</label>
            <input id="fallback" type="color" value="#111111" />
          </div>
          <div class="row">
            <label for="strokeW">Outline width</label>
            <input
              id="strokeW"
              type="number"
              min="0"
              max="20"
              step="1"
              value="0"
            />
          </div>
        </div>
        <div class="row">
          <label for="strokeC">Outline color</label>
          <input id="strokeC" type="color" value="#000000" />
        </div>
      </section>

      <!-- Stage -->
      <section class="stage" id="stage">
        <div class="masked-wrap" id="wrap">
          <div
            id="display"
            class="masked-text"
            contenteditable="true"
            spellcheck="false"
          >
            MASKED TEXT
          </div>
          <div class="hint">
            Double-click to edit. Press <span class="kbd">Esc</span> to leave
            editing.
          </div>
        </div>
      </section>
    </main>

    <script>
      const root = document.documentElement;
      const wrap = document.getElementById("wrap");
      const display = document.getElementById("display");
      const stage = document.getElementById("stage");

      // Controls
      const elText = document.getElementById("text");
      const elFont = document.getElementById("font");
      const elWeight = document.getElementById("weight");
      const weightVal = document.getElementById("weightVal");

      const elFit = document.getElementById("fit");
      const elPercent = document.getElementById("percent");
      const pctVal = document.getElementById("pctVal");

      const elPosX = document.getElementById("posX");
      const elPosY = document.getElementById("posY");
      const posXVal = document.getElementById("posXVal");
      const posYVal = document.getElementById("posYVal");

      const elImg = document.getElementById("img");
      const elFallback = document.getElementById("fallback");

      const elStrokeW = document.getElementById("strokeW");
      const elStrokeC = document.getElementById("strokeC");

      const btnFallback = document.getElementById("toggleFallback");
      const btnReset = document.getElementById("reset");

      const btnS1 = document.getElementById("useSample1");
      const btnS2 = document.getElementById("useSample2");
      const btnS3 = document.getElementById("useSample3");

      // --- helpers
      function setVar(name, value) {
        root.style.setProperty(name, value);
      }
      function applyBgSize() {
        if (elFit.value === "percent") {
          setVar("--bg-size", `${elPercent.value}% auto`);
          pctVal.textContent = `${elPercent.value}%`;
        } else {
          setVar("--bg-size", elFit.value);
        }
      }
      function setImage(url) {
        setVar("--img", `url("${url}")`);
      }
      function clamp(val, min, max) {
        return Math.min(Math.max(val, min), max);
      }

      // --- init defaults
      applyBgSize();
      setVar("--posX", `${elPosX.value}%`);
      setVar("--posY", `${elPosY.value}%`);
      setVar("--fallback", elFallback.value);
      setVar("--stroke-w", `${elStrokeW.value}px`);
      setVar("--stroke-c", elStrokeC.value);

      // --- bindings
      elText.addEventListener(
        "input",
        () => (display.textContent = elText.value || " ")
      );

      display.addEventListener("input", () => {
        elText.value = display.textContent.replace(/\n/g, " ");
      });
      display.addEventListener("keydown", (e) => {
        if (e.key === "Escape") {
          display.blur();
        }
      });

      elFont.addEventListener("change", () => setVar("--font", elFont.value));
      elWeight.addEventListener("input", () => {
        weightVal.textContent = elWeight.value;
        setVar("--weight", elWeight.value);
      });

      elFit.addEventListener("change", applyBgSize);
      elPercent.addEventListener("input", applyBgSize);

      elPosX.addEventListener("input", () => {
        setVar("--posX", `${elPosX.value}%`);
        posXVal.textContent = `${elPosX.value}%`;
      });
      elPosY.addEventListener("input", () => {
        setVar("--posY", `${elPosY.value}%`);
        posYVal.textContent = `${elPosY.value}%`;
      });

      elImg.addEventListener("change", () => setImage(elImg.value));
      elFallback.addEventListener("input", () =>
        setVar("--fallback", elFallback.value)
      );

      elStrokeW.addEventListener("input", () =>
        setVar("--stroke-w", `${clamp(+elStrokeW.value, 0, 20)}px`)
      );
      elStrokeC.addEventListener("input", () =>
        setVar("--stroke-c", elStrokeC.value)
      );

      btnFallback.addEventListener("click", () => {
        wrap.classList.toggle("fallback");
        btnFallback.textContent = wrap.classList.contains("fallback")
          ? "Use Image Mask"
          : "Toggle Fallback";
      });

      btnReset.addEventListener("click", () => {
        // state
        wrap.classList.remove("fallback");
        elText.value = "MASKED TEXT";
        display.textContent = "MASKED TEXT";

        elFont.value = '"Bebas Neue", system-ui, sans-serif';
        setVar("--font", elFont.value);

        elWeight.value = 900;
        weightVal.textContent = "900";
        setVar("--weight", 900);

        elFit.value = "cover";
        elPercent.value = 120;
        pctVal.textContent = "120%";
        applyBgSize();

        elPosX.value = 50;
        elPosY.value = 50;
        setVar("--posX", "50%");
        setVar("--posY", "50%");
        posXVal.textContent = "50%";
        posYVal.textContent = "50%";

        const defImg =
          "https://images.unsplash.com/photo-1500530855697-b586d89ba3ee?q=80&w=1600&auto=format&fit=crop";
        elImg.value = defImg;
        setImage(defImg);

        elFallback.value = "#111111";
        setVar("--fallback", "#111111");

        elStrokeW.value = 0;
        setVar("--stroke-w", "0px");
        elStrokeC.value = "#000000";
        setVar("--stroke-c", "#000000");
        btnFallback.textContent = "Toggle Fallback";
      });

      // Quick samples
      btnS1.addEventListener("click", () => {
        const url =
          "https://images.unsplash.com/photo-1526778548025-fa2f459cd5c1?q=80&w=1600&auto=format&fit=crop";
        elImg.value = url;
        setImage(url);
      });
      btnS2.addEventListener("click", () => {
        const url =
          "https://images.unsplash.com/photo-1508057198894-247b23fe5ade?q=80&w=1600&auto=format&fit=crop";
        elImg.value = url;
        setImage(url);
      });
      btnS3.addEventListener("click", () => {
        const url =
          "https://images.unsplash.com/photo-1526318472351-c75fcf070305?q=80&w=1600&auto=format&fit=crop";
        elImg.value = url;
        setImage(url);
      });

      // Bonus: click-drag to pan the image
      let dragging = false,
        startX = 0,
        startY = 0,
        baseX = 50,
        baseY = 50;
      stage.addEventListener("pointerdown", (e) => {
        dragging = true;
        startX = e.clientX;
        startY = e.clientY;
        baseX = parseFloat(getComputedStyle(root).getPropertyValue("--posX"));
        baseY = parseFloat(getComputedStyle(root).getPropertyValue("--posY"));
        stage.setPointerCapture(e.pointerId);
      });
      stage.addEventListener("pointermove", (e) => {
        if (!dragging) return;
        const dx = ((e.clientX - startX) / stage.clientWidth) * 100;
        const dy = ((e.clientY - startY) / stage.clientHeight) * 100;
        const x = clamp(baseX + dx, 0, 100);
        const y = clamp(baseY + dy, 0, 100);
        elPosX.value = x.toFixed(0);
        elPosY.value = y.toFixed(0);
        posXVal.textContent = `${elPosX.value}%`;
        posYVal.textContent = `${elPosY.value}%`;
        setVar("--posX", `${elPosX.value}%`);
        setVar("--posY", `${elPosY.value}%`);
      });
      stage.addEventListener("pointerup", (e) => {
        dragging = false;
        stage.releasePointerCapture?.(e.pointerId);
      });
      stage.addEventListener("pointercancel", () => (dragging = false));
    </script>
  </body>
</html>
